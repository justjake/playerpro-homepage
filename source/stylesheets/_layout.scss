/*
    Layout.scss
    Page framework definitions
*/

@import "globals";

$col-padding: 10px;

// Global stylistic sizing
$global-header-height: 40px;
$page-size: 1070px;

// breakpoints
$iphone-width: 480px;
$tablet-width: 768px;
$widescreen-width: $page-size;


// column sizing
$data-col-size: 280px;
$right-aux-col-size: 210px;
$calculated-center-col-size: $page-size - ($col-padding + $data-col-size + $right-aux-col-size);

$iphone  : new-breakpoint(max-width $iphone-width);
$mobile  : $iphone;
// $mobile  : new-breakpoint(max-width $mobile-width);
$tablet: new-breakpoint(min-width $iphone-width max-width $tablet-width);
// TODO: refactor this to a better name
$desktop : new-breakpoint($iphone-width);
$gt-tablet: new-breakpoint($tablet-width);
$widescreen : new-breakpoint($page-size);

// visual grid for devel
$DEVEL: true;

/* Responsive */
@mixin only-visible-at($breakpoint, $display-mode: block) {
    display: none;
    @include media($breakpoint) {
        display: $display-mode;
    }
}

@mixin mobile-only($display-mode: block) {
    @inlcude only-visible-at($mobile, $display-mode);
}

@mixin desktop-only($display-mode: block) {
    @include only-visible-at($desktop, $display-mode);
}

@mixin widescreen-only($display-mode: block) {
    @include only-visible-at($widescreen, $display-mode);
}

/* sticky footer */
html, body {
  height: 100%;
  margin: 0;
}

body {
  display: table;
  width: 100%;
}

header.main, .page, .footer.main {
  display: table-row;
  height: 1px;
  & > .container {
    display: table-cell;
    position: relative;
  }
}

.page {
  height: 100%;

  & > .container {
      padding-top: $global-header-height * 2;
      @include media($desktop) {
          padding-top: $global-header-height;
      }
      min-height: 100%;
  }
}

header.main {
    @include position(fixed, 0px 0px 0 0px);
    display: block;
}

/* page columns */

.page > .container, footer.main > .container, header.main > .container {
    margin: 0 auto;
    display: block;
    @include media($desktop) {
        padding-left: $col-padding;
        max-width: $col-padding + $data-col-size + $calculated-center-col-size;
        //padding-left: 10px;
        // @include row(table)
    }
    @include media($widescreen) {
        max-width: $page-size;
    }
}

.left-data-col, .center-col, .right-aux-col {
    @include box-sizing(border-box);
    @include clearfix;

    @include media($desktop) {
        padding: $col-padding $col-padding 0 $col-padding;
    }
    padding-top: $col-padding;


    vertical-align: top;
    position: relative;
}

.left-data-col {
    @include media($desktop) {
        display: table-cell;
        width: $data-col-size;
        padding-left: 0;
        padding-right: 0;
    }

    @include media($tablet) {
        display: block;
        width: auto;
        padding-right: $col-padding;
        .card-sidebar {
            float: left;
            margin-right: $col-padding;
            margin-bottom: $col-padding;
        }
        .module {
            overflow: hidden;
        }
    }
}

.center-col {
    @include media($desktop) {
        display: table-cell;
    }
    @include media($tablet) {
        padding-left: 0;
    }
}

.right-aux-col {
    width: $right-aux-col-size;
    @include widescreen-only(table-cell);
}



/* shrink everything for small phones */
body {
    @include media($iphone) {
        font-size: em(12px);
    }
}

/* column styling */

.center-col {
    @include media($tablet) {
        .carousel {
            display: none;
        }
    }
}

.left-data-col {
    .module {
        @include module;
        @include box-sizing(border-box);
        padding: $col-padding;
        margin-bottom: $col-padding;

        p:last-child {
            margin: 0;
        }

    }
}

.right-aux-col {
    // @TODO move module definition elsewhere
    .module {
        @include module;
        @include box-sizing(border-box);
        position: absolute;
        top: 0px;
        bottom: 0px;
        width: $right-aux-col-size;

        border-radius: 0;
        padding: $col-padding;
        border-left: 1px solid #ddd;
    }
}

.page .right-aux-col {
    @include module;
    border-radius: 0;
    vertical-align: middle;
    text-align: center;
}

/* hide carousel on mobile: defer to card for visual content */
.center-col .carousel {
    @include media($mobile) {
        display: none;
    }
}
